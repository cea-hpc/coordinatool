{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a5ee722e_8a99cb79",
        "filename": "common/lustre.c",
        "patchSetId": 1
      },
      "lineNbr": 191,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-09-21T12:19:19Z",
      "side": 1,
      "message": "question: this case only occures if the last character of the output is not \u0027\\n\u0027, right? I think moving this condition just after the \"parsing\" while loop, is enough to handle this case properly, no? You could then just try to parse the end.\n\nObviously, for this to work, you have to use another variable inside the while loop for the result of `parse_active_request_line`.",
      "range": {
        "startLine": 191,
        "startChar": 5,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "b6b446c2de40cd304ba22be78dd1dfa83e383e9c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cff01a25_0de07ac5",
        "filename": "common/lustre.c",
        "patchSetId": 1
      },
      "lineNbr": 191,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2021-09-21T13:05:27Z",
      "side": 1,
      "message": "yes, that will occur if the file does not finish with a newline.\nCould  let the n \u003d\u003d 0 break exit the loop, and move this check as if (!rc \u0026\u0026 line !\u003d end) after the while (true) loop if that\u0027s what you meant?\nbut I don\u0027t think that helps much with code readability, so not sure why you\u0027re suggesting that?\n\nparsing the last line without a trailing \\n won\u0027t happen with the current code because of the strchr, would need to rework the inner loop a bit.\nIt\u0027s definitely possible but we can just request input to be formatted properly, and deal with it if we ever see lustre generate such output.",
      "parentUuid": "a5ee722e_8a99cb79",
      "range": {
        "startLine": 191,
        "startChar": 5,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "b6b446c2de40cd304ba22be78dd1dfa83e383e9c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c270813_49ad4d70",
        "filename": "common/lustre.c",
        "patchSetId": 1
      },
      "lineNbr": 191,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-09-21T14:26:23Z",
      "side": 1,
      "message": "Yes, I missed the \"n\u003d\u003d0 \u003d\u003e break\" below. My point was that we can easily parse the last line as well instead of ignoring it. I was not talking about the code readability here.\n\nI may be wrong but I think something like the following would parse the last line correctly:\n\nmove both ifs: `(n \u003d\u003d 0 \u0026\u0026 line !\u003d end)` and `(n \u003d\u003d 0)` after the while loop.\n\n```\nwhile (strchr) {\n    ...\n}\n\nif (n \u003d\u003d 0 \u0026\u0026 line !\u003d end)\n   parse_active_request_line(line, ...); // \u003c\u003c not complete\nelse if (n \u003d\u003d 0)\n   break;\n```",
      "parentUuid": "cff01a25_0de07ac5",
      "range": {
        "startLine": 191,
        "startChar": 5,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "b6b446c2de40cd304ba22be78dd1dfa83e383e9c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4032311a_8ddc3e29",
        "filename": "common/lustre.c",
        "patchSetId": 1
      },
      "lineNbr": 191,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2021-09-21T15:28:12Z",
      "side": 1,
      "message": "That moves usage of \u0027n\u0027 way too late after its assignment - you can just keep it where it is, replacing the error with parse_active_request_line() and stopping there.\nThe n \u003d\u003d 0 check guarantees that there won\u0027t be any other line to parse so there is no need for the loop in that iteration.\n\nI don\u0027t really mind either way, as I said I think it\u0027d be enough taking care of it when/if lustre ever outputs such message, but I also agree being tolerant in the input we accept doesn\u0027t hurt.\nFeel free to send the patch :)",
      "parentUuid": "1c270813_49ad4d70",
      "range": {
        "startLine": 191,
        "startChar": 5,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "b6b446c2de40cd304ba22be78dd1dfa83e383e9c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}