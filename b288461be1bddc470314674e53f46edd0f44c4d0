{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "734e3282_0926b0b6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2021-09-16T23:20:30Z",
      "side": 1,
      "message": "ah, sorry I\u0027ve added a similar commit recently for client recovery\nhttps://github.com/martinetd/coordinatool/commit/cdcc2194e88f73a219762cb6b3144cccef27495f\n\n\nI hadn\u0027t realized the repo had been cloned to cea-hpc, I\u0027m happy to send new patches to gerrithub from now, just need to decide what to do with this",
      "revId": "b288461be1bddc470314674e53f46edd0f44c4d0",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8187dd65_3c8e7dc0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-09-17T06:59:19Z",
      "side": 1,
      "message": "As far as I understand, you\u0027ve added the hostname in ct_state.client_id in this patch. But this struct is related to client side code. This patch is for server side hostname handling. Am I wrong somewhere?",
      "parentUuid": "734e3282_0926b0b6",
      "revId": "b288461be1bddc470314674e53f46edd0f44c4d0",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4632b946_40ffcae8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2021-09-17T07:14:10Z",
      "side": 1,
      "message": "Yes, this patch just sets ct_state.client_id in the client, but the previous one(s) send the client_id to the server immediately after connect (new ehlo protocol message) -- I\u0027d much prefer using that for client-\u003ehost rather than sockaddr2str, and you can safely assert it has to be set in order for recv to work (just need to add ehlo for the cli client before it sends recv.. I didn\u0027t want it to trigger recovery mechanisms so it doesn\u0027t normally send one)\nThat\u0027ll avoid problems we can have with full network hostname on different interfaces (e.g. connecting over admin subnet but transfers over a data backbone), and that\u0027s why I didn\u0027t rely on sockaddr2str there. I didn\u0027t store it in the client struct because I had no immediate use for it outside of the ehlo reply handler, but that\u0027s trivial to add.\n\n(Note the addr should still be kept for logs, we\u0027ll want to at least match the two once for debug logs, then the addr can be freed eventually)\n\n\nI hadn\u0027t read this patch fully, the part with the coordinatool hostname can definitely be kept too, although I\u0027m not sure what it\u0027s used for? but that might make more sense after reading the other patch in detail.",
      "parentUuid": "8187dd65_3c8e7dc0",
      "revId": "b288461be1bddc470314674e53f46edd0f44c4d0",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b639c6fd_41b53f85",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-09-17T07:25:36Z",
      "side": 1,
      "message": "The coordinatool hostname is necessary because of how the phobos_locate call works.\n\nIf it finds no suitable hostname to use, it will send back the current hostname. The assumption in the design of locate was that it would only be done on servers with an LRS and at least one drive thus capable of doing phobos operations. The use of it in the context of the coordinatool was not taken into account.\n\nKnowing the hostname of the coordinatool allows to make sure that we don\u0027t try to send remove or restore requests to the coordinatool\u0027s hostname as there is no phobos client there.",
      "parentUuid": "4632b946_40ffcae8",
      "revId": "b288461be1bddc470314674e53f46edd0f44c4d0",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}